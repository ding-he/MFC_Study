# VC++深入详解 孙鑫 代码实现
代码基于Visual Studio 2013对孙鑫老师的经典书籍做了完整的实现.
## 感谢孙鑫老师的教导
---
+ **第一章** [Lesson01](Lesson01)  
>Windows程序运行原理及程序编写流程，窗口产生过程，句柄原理，消息队列，回调函数,窗口关闭与应用程序退出的工作关系，使用VC++的若干小技巧，`stdcall`与`cdecl`调用规范的比较，初学者常犯错误及注意事项。
+ **第二章** [Lesson02](Lesson02)  
>C++经典语法与应用，类的编写与应用，构造与析构函数，函数的重载,类的继承，函数覆盖，基类与派生类的构造函数、析构函数调用顺序，如何在派生类构造函数中向基类的构造函数传递参数，`this` 成员变量，类型转换的内幕，虚拟函数与多态性，引用和指针变量的区别与共同处。VC工程的编译原理与过程，将工程中不同的类拆分到不同的文件中，每- -个类由一个h和.cpp文件共同完成，头文件重复定义问题的解决，培养了学员良好的编程习惯，也为以后分析MFC AppWizard生成的工程奠定良好基础。
+ **第三章** [Lesson03](Lesson03)  
>讲述MFC AppWizard的原理与MFC程序框架的剖析。AppWizard是- -个源代码生成工具，是计算机辅助程序设计工具，WinMain 在MFC程序中是如何从源程序中被隐藏的，`theApp` 全局变量是如何被分配的，MFC框架中的几个类的作用与相互关系，MFC框架窗口是如何产生和销毁的，对窗口类的`PreCreateWidow`和`OnCreate`两个函数的着重分析，Windows 窗口与C++中的`CWnd`类的关系。
+ **第四章** [Lesson04](Lesson04)  
>MFC 消息映射机制的剖析，讲述如何运用ClassWizard, 理解发送给窗口的消息是如何被MFC框架通过窗口句柄映射表和消息映射表来用窗口类的函数进行响应的掌握设备描述表及其封装类`CDC`的使用，`CDC`是如何与具体的设备发生关联的，融合具体的画图程序进行分析。如何设置封闭图形的填充刷子(位图画刷与透明画刷的使用)。
+ **第五章** [Lesson05](Lesson05)
>掌握`CDC`的文字处理程序的编写，如何产生自定义字体和自定义插入符，熟悉对`CString`类的使用。通过对卡拉OK程序的编写，讲解定时器的使用和`DrawText`函.数的巧妙运用，讲解如何使用`CDC`的裁减功能。
+ **第六章** [Lesson06](Lesson06)  
>菜单的工作原理及编写应用，菜单命令消息在MPC框架程序的几个类中的传递顺序和处理过程。标记菜单、默认菜单的实现原理、图形菜单的实现及常犯错误的分析，`GetSystemMetrics` 的应用，弹出快捷菜单的实现方式及其命令响应函数有效范围(与弹出菜单时所指定的父窗口有密切的关系，最底层的子窗口具有最优先的处理机会)。动态菜单的编写，如何让程序在运行时产生新的菜单项及如何手工为这些新产生的菜单命令安排处理函数,如何在顶层窗口中截获对菜单命令的处理，更进一步掌握`CString`类的应用。
+ **第七章** [Lesson07](Lesson07)  
>对话框用户界面程序的编写，如何向对话框控件关联数据成员及其实现机理，如何利用对话框类的成员函数向控件发送消息和获取对话框控件的类指针，如何直接利用对话框控件类操纵对话框控件(发送消息和直接调用成员函数)，如何在程序运行时产生和销毁控件。对话框控件的几种操作方式的优劣比较分析。如何实现对话框的部分收缩和展开。如何让对话框上的文本框在程序启动后立即获得焦点，如何利用`SetWindowLong`改变窗口的回调函数，通过改变文本框的默认回车处理方式进行演示。实现多个输入文本框间通过回车逐一-向 下传递焦点的另一种巧妙方法(用默认按钮来处理)。
+ **第八章** [Lesson08](Lesson08)  
>逃跑按钮的巧妙实现。如何制作属性页对话框和向导对话框，融合讲解组合框(如何调整组合框的大小)、列表框、单选按钮、复选按钮等常用对话框控件的多种使用方法。如何限制用户在不满足设定的条件时切换到其他属性页和向导页。
+ **第九章** [Lesson09](Lesson09)  
>如何修改MFC AppWizard向导生成的框架程序的外观和大小，修改图标、光标、背景的三种方法。如何增加和删除工具栏按钮，如何给应用程序增加工具栏，如何显示和隐藏工具栏。定制状态栏，在状态栏中添加时钟显示，`CTime` 类及其用法。在状态栏中添加进度条(主窗口产生后立即产生进度条的巧妙思想,不能在`OnCreate`函数中直接处理，要用到自定义消息的方法)。鼠标坐标显示，在`CView`中获取状态栏对象的几种方式。如何为应用程序添加启动画面。
+ **第十章** [Lesson10](Lesson10)  
>图形的绘制，如何使用自定义画笔(颜色，线宽，线型)。如何为程序中添加选项菜单和选项设置对话框，如何使用标准颜色对话框，如何使用字体对话框，在选项对话框中实现预览功能。实现选项对话框和窗口类中的数据交换。如何改变对话框和控件的背景色，如何改变控件的文本颜色，对按钮控件的特殊处理。如何在窗口中显示一幅位图。
+ **第十一章** [Lesson11](Lesson11)  
>如何让`CDC`上输出的文字、图形具有保持功能，集合类`CPtrArray`的使用，`CPaintDC`与`CClientDC`的区别与应用, `OnPaint`与`OnDraw`在`CView`中的关系及实现内幕,滚动窗口的实现，坐标空间、映射方式、设备坐标与逻辑坐标的转换。元文件设备描述表的使用，如何利用兼容DC实现图形的保存和再现。
+ **第十二章** [Lesson12](Lesson12)  
>`const char *`与`char * const`的区别。C语言对文件读写的支持，`FILE` 指针;文本文件和二进制文件的区别。用文本方式读写文件和以二进制方式读写文件的注意事项。C++对文件读写的支持，`ofstream` 和`ifstream`的用法。Win32 SDK对文件读写的支持，`CreateFile`函数、`WriteFile` 函数、`ReadFile` 函数的使用; MFC对文件读写的支持，`CFile` 类和`CFileDialog`的使用，文件过滤器的设置。Win.ini 文件和注册表的读写方式及相关知识点。
+ **第十三章** [Lesson13](Lesson13)  
>使用`CArchive`类对文件进行操作。MFC框架程序提供的文件新建与打开功能内部的实现机制。如何利用`CDocument`类的串行化存储功能保存与加载数据。如何实现类对串行化的支持，`CObArray`的串行化实现内幕。删除文档数据时常犯的错误。MFC框架程序的文档类和视类的关系，以及如何获得相互的指针引用。
+ **第十四章** [Lesson14](Lesson14)  
>网络的相关知识，网络程序的编写，`Socket` 是连接应用程序与网络驱动程序的桥梁，`Socket`在应用程序中创建，通过`bind`与驱动程序建立关系。此后，应用程序送给Socket的数据，由`Socket`交给驱动程序向网络上发送出去。计算机从网络上收到与该`Socket`绑定的IP+Port相关的数据后，由驱动程序交给`Socket`，应用程序便可从该`Socket`中提取接收到的数据。网络应用程序就是这样通过`Socket`进行数据的发送与接收的。`TCP`与`UDP`的工作原理与编写过程，如何在程序中链接库文件，一个字符界面的聊天程序。
+ **第十五章** [Lesson15](Lesson15)  
>多线程程序的编写，多线程应用中容易出现的问题。互斥对象的讲解，如何使用互斥对象来实现多线程的同步。如何利用命名互斥对象保证应用程序只有-一个实例运行。应用多线程编写网络聊天室程序。
+ **第十六章** [Lesson16](Lesson16)  
>事件内核对象、关键代码段(临界区)的讲解，以及在多线程同步中的应用。在Windows下编写基于消息的网络应用程序，掌握阻塞与非阻塞网络程序的编写，理解在Windows平台下，采用异步选择机制可以提高网络应用程序的性能。
+ **第十七章** [Lesson17](Lesson17)  
>详细讲解进程间通信的四种方式:剪贴板、匿名管道、命名管道和邮槽，并比较分析这几种进程间通信的优点和缺点。
+ **第十八章** [Lesson18](Lesson18)  
>ActiveX 控件的应用与工作原理。ActiveX 控件的编写，如何为控件安排属性、方法、事件、属性页、持久性存储，控件如何通知容器自身属性的改变。如何注册控件与取消控件注册，在VB和VC中访问ActiveX控件。
+ **第十九章** [Lesson19](Lesson19)  
>动态链接库程序的编写。静态库与动态库的区别，以及调用程序在链接静态库和动态库时的区别。如何利用工具查看动态链接库输出的函数, Depends工具的使用，C++编译器名字改编技术对动态链接库输出函数的影响，`extern“C`的用法，利用模块定义文件来解决C++名字改编的问题。用`typedef `定义指向函数的指针类型，如何获得动态连接库里的函数的指针。
+ **第二十章** [Lesson20](Lesson20)  
>`Hook` 编程。如何安装钩子过程，如何编写全局钩子。动态连接库里的全局变量数据共享问题分析。`ADO`数据库编程。在VB中利用`ADO`控件和`ADO`对象访问数据库，在VC中利用`ADO`技术访问数据库。
